jQuery(document).ready(function(d){var i,k=d("#email"),j=d("#ID"),a=d(".avatar"),l=d("form#subscriber_form"),e=d("#_wpnonce").val();function h(){c();d(".piechart").easyPieChart({animate:1000,rotate:180,barColor:"#2BB3E7",trackColor:"#50626f",trackColor:"#ffffff",lineWidth:9,size:75,lineCap:"butt",onStep:function(m){this.$el.find("span").text(Math.round(m))},onStop:function(m){this.$el.find("span").text(Math.round(m))}})}function c(){d("#subscriber_form").on("submit",function(){clearTimeout(i);k.off("blur").off("keyup");d(this).submit(false)});d(".detail").on("click",function(){var p=d(this).addClass("active"),o=p.find(".click-to-edit"),n=o.find("> li").first(),m=o.find("> li").last();if(!n.is(":hidden")){n.hide();m.show().find("input").first().focus().select();m.show().find("textarea").first().focus().select()}});d("#mailster_status").on("change",function(){if(d(this).val()<=0){d(".pending-info").show()}else{d(".pending-info").hide()}});d(".show-more-info").on("click",function(){d(".more-info").slideToggle(100)});d(".map.zoomable").on("click",function(){var n=d(this),m=n.find("img");if(!m.hasClass("zoomed")){m.attr("src",m.attr("src").replace(/zoom=\d+/,"zoom=11")).addClass("zoomed")}else{m.attr("src",m.attr("src").replace(/zoom=\d+/,"zoom=5")).removeClass("zoomed")}});if(typeof jQuery.datepicker=="object"){d("input.datepicker").datepicker({dateFormat:"yy-mm-dd",firstDay:mailsterL10n.start_of_week,dayNames:mailsterL10n.day_names,dayNamesMin:mailsterL10n.day_names_min,monthNames:mailsterL10n.month_names,prevText:mailsterL10n.prev,nextText:mailsterL10n.next,showAnim:"fadeIn",onClose:function(){var m=d(this).datepicker("getDate");d(".deliverydate").html(d(this).val())}})}k.on("blur",function(){var o=d(this),m=d.trim(o.val()),n=b(m);if(!n){d(".email-error").slideUp(100,function(){d(this).remove()});d('<p class="email-error">&#9650; '+mailsterL10n.invalid_email+"</p>").hide().insertAfter(o).slideDown(100);setTimeout(function(){o.focus(),1});l.prop("disabled",true)}else{d(this).val(m);if(a.data("email")!=m){a.addClass("avatar-loading");g(m,function(p){if(p.success){a.data("email",m).removeClass("avatar-loading").css({"background-image":"url("+p.url.replace(/&amp;/,"&")+")"})}})}}if(!m||!n){l.prop("disabled",true)}o.trigger("keyup")}).on("keyup",function(){var m=d(this);clearTimeout(i);i=setTimeout(function(){var n=d.trim(m.val()),o=b(n);if(!o){return false}f("check_email",{email:n,id:j.val()},function(p){l.prop("disabled",p.exists);d(".email-error").slideUp(100,function(){d(this).remove()});if(p.exists){d('<p class="email-error">&#9650; '+mailsterL10n.email_exists+"</p>").hide().insertAfter(m).slideDown(100);setTimeout(function(){m.focus(),1})}})},400);l.prop("disabled",true)})}function b(m){return true;return !m||/^([\w-+]+(?:\.[\w-]+)*)\@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$|(\[?(\d{1,3}\.){3}\d{1,64}\]?)$/.test(m)}function g(m,n){f("get_gravatar",{email:m},n)}function f(o,n,p,m){if(d.isFunction(n)){if(d.isFunction(p)){m=p}p=n;n={}}d.ajax({type:"POST",url:ajaxurl,data:d.extend({action:"mailster_"+o,_wpnonce:e},n),success:function(r,s,q){p&&p.call(this,r,s,q)},error:function(q,s,r){if(s=="error"&&!r){return}if(console){console.error(d.trim(q.responseText))}m&&m.call(this,q,s,r)},dataType:"JSON"})}h()});